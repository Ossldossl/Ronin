__check :: fn(ref: &Reference<T>, test: i32)
    if ref.ptr.generation != ref.expected_generation do
        ref = nil
    end
end